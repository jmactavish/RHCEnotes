yum -y install python-devel gcc*
cd
git clone git://git.gnome.org/libxml2
cd libxml2* && ./configure --prefix=/usr/local/libxml2 && make && make install
cd
wget sourceforge.net/projects/mcrypt/files/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz
tar -xzvf libmcrypt-2.5.8.tar.gz && rm -f libmcrypt-2.5.8.tar.gz
cd libmcrypt-2.5.8 && ./configure --prefix=/usr/local/libmcrypt && make && make install
cd libltdl/ && ./configure --enable-ltdl-install && make && make install
cd
wget http://sourceforge.net/projects/mhash/files/mhash/0.9.9.9/mhash-0.9.9.9.tar.gz
tar -xzvf mhash* && rm -f mhash*.tar.gz
cd mhash* && ./configure && make && make install
cd
wget http://sourceforge.net/projects/mcrypt/files/MCrypt/2.6.8/mcrypt-2.6.8.tar.gz
tar -xzvf mcrypt* && rm -f mcrypt*.tar.gz
export LDFLAGS="-L/root/mhash-0.9.9.9/lib/ -I/root/mhash-0.9.9.9/include/"
export CFLAGS="-I/root/mhash-0.9.9.9/include/"
cd mcrypt* && LD_LIBRARY_PATH=/usr/local/libmcrypt/lib:/usr/local/lib ./configure --with-libmcrypt-prefix=/usr/local/libmcrypt && make && make install
unset CFLAGS && unset LDFLAGS
cd
wget http://zlib.net/zlib-1.2.8.tar.gz
tar -xzvf zlib* && rm -f zlib*.tar.gz
cd zlib* && ./configure
#sed -i '/CFLAGS/s/$/-fPIC/' Makefile && 
make && make install
cd
wget sourceforge.net/projects/libpng/files/libpng16/1.6.19/libpng-1.6.19.tar.gz
tar -xzvf libpng*.tar.gz && rm -f libpng*.tar.gz
cd libpng* && ./configure --prefix=/usr/local/libpng && make && make install
cd
#'failed to install libpng orz pngfix.c:2185: undefined reference to `inflateReset2'
wget http://www.ijg.org/files/jpegsr6b.zip
mkdir -p /usr/local/jpeg6/{bin,lib,include,/man/man1}
unzip jpeg*.zip && rm -f jpeg*.zip
cd jpeg* && chmod -R +x *
cp -f /usr/share/libtool/config/{config.sub,config.guess} . && ./configure --prefix=/usr/local/jpeg6 --enable-shared --enable-static
make && make install
cd
#'met an error again --> -bash: ./configure: /bin/sh^M: bad interpreter: No such file or directory'
wget http://download.savannah.gnu.org/releases/freetype/freetype-2.4.0.tar.gz
tar -xzf freetype* && rm -f freetype*.tar.gz
cd freetype* && ./configure --prefix=/usr/local/freetype && make && make install
cd
wget https://github.com/libgd/libgd/releases/download/gd-2.1.1/libgd-2.1.1.tar.gz
tar -xzf libgd* && rm -f libgd*.tar.gz
mkdir /usr/local/gd2
cd libgd*
sed -i '/png.h/s@png.h@/usr/local/libpng/include/png.h@' gd_png.c #'ahh this file doesn't exist!!!'
./configure --prefix=/usr/local/gd2 --with-jpeg=/usr/local/jpeg6/ --with-freetype=/usr/local/freetype/ --with-png=/usr/local/libpng/
make && make install
cd
wget http://mirror.bit.edu.cn/apache//httpd/httpd-2.4.17.tar.gz
tar -xzf httpd-2.4* && rm -f httpd-2.4.17.tar.gz
wget http://apache.fayea.com//apr/apr-1.5.2.tar.gz
tar -xzf apr-1* && rm -f apr-1*.tar.gz
wget http://apache.fayea.com//apr/apr-util-1.5.4.tar.gz
tar -xzf apr-util* && rm -f apr-util*.tar.gz
cp -r apr-1.5.2/ httpd-2.4.17/srclib/apr
cp -r apr-util-1.5.4/ httpd-2.4.17/srclib/apr-util
cd
yum -y install pcre-devel
cd httpd*
./configure --prefix=/usr/local/apache2 --sysconfdir=/usr/local/apache2/etc --with-included-apr --enable-so --enable-deflate=shared --enable-expires=shared --enable-rewrite=shared
make && make install
cd
service httpd stop
chkconfig httpd off
setenforce 0
sed -i '/SELINUX=enabled/s/enabled/permissive/' /etc/sysconfig/selinux
iptables -F
iptables -X
service iptables save
/usr/local/apache2/bin/apachectl start
echo '/usr/local/apache2/bin/apachectl start' >> /etc/rc.d/rc.local

yum -y install ncurses-devel cmake bison
useradd mysql
wget https://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.27.tar.gz
tar -xzf mysql* rm -f !$
cd mysql*
cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DEXTRA_CHARSETS=all -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci _DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_MEMORY_STORAGE_ENGINE=1 -DWITH_READLINE=1 -DENABLED_LOCAL_INFILE=1 -DMYSQL_USER=mysql _DMYSQL_TCP_PORT=3306
make && make install
cd
chown -R root /usr/local/mysql/*
chown -R mysql /usr/local/mysql/data
cp fy /usr/local/mysql/support-files/my-medium.cnf /etc/my.cnf
/usr/local/mysql/scripts/mysql_insatll_db --user=mysql
/usr/local/mysql/bin/mysql_safe --user=mysql &
#'may need to press "enter" here'
/usr/local/mysql/bin/mysqladmin -uroot password 'passw0rd'

yum -y install libtool*
sed -i '/qd_free/s/$/\n\nvoid {"data};/' /usr/local/gd2/include/gd_io.h
yum -y install libxml2-devel
git clone https://github.com/php/php-src.git
cd php-src && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-zpxs2=/usr/local/apache2/bin/apxs --with-mysql=/usr/local/mysql --with-libxml-dir=/usr/local/libxmls --with-jpeg-dir=/usr/local/jpeg6/ --with-png-dir=/usr/local/libpng --with-freetype-dir=/usr/local/freetype/ --with=gd=/usr/local/gd2 --with-mcrypt=/usr/local/libmcrypt --with-mysqli=/usr/local/mysql/bin/mysql_config --enable-soap --enable-mbstring=all --enable-sockets --with-pdo-mysql=/usr/local/mysql --without-pear
make && make install
cd
mkdir -p /usr/local/php/etc
cp php.ini-production /usr/local/php/etc/php.ini
sed -i '/AddType/s/^/AddType application/x-httpd-php .php .phps .phtml\n/' /usr/local/apache2/etc/httpd.conf
/usr/local/apache2/bin/apachectl stop && /usr/local/apache2/bin/apachectl start
echo '
<?php
phpinfo();
?>
' > /usr/localapache2/hcdocs/index.php
echo '
<?php
$link=mysql_connect('localhost','root','passw0rd');
if($link) echo "this is the mysql test page";
mysql_close();
?>
' > /usr/localapache2/hcdocs/mysql.php

wget https://files.phpmyadmin.net/phpMyAdmin/4.5.2/phpMyAdmin-4.5.2-all-languages.tar.gz
tar -xzf phpMyAdmin* && rm !$
cp -r phpMyAdmin* /usr/local/apache2/htdocs/phpmyadmin
cd !$ && cp config.sample.inc.php config.inc.php && sed -i '/auth_type/s/cookie/http/' config.inc.php
cd

wget http://download.comsenz.com/Discuz/7.2/Discuz_7.2_SC_UTF8.zip
unzip Discuz_7.2_SC_UTF8.zip && rm -f !$ && cp -r Discuz*/upload /usr/local/apache2/htdocs/bbs
cd !$ && chown -R daemon:daemon attachments/ forumdata/ config.inc.php teplates/ uc_client/data/cache/
cd
/usr/local/mysql/bin/mysql -uroot -p
create database bbs;
grant all on bbs.* to bbs_admin@'192.168.57.0/24' identified by 'passw0rd';
exit
sed -i '/short_open_tag/s/off/on/' /usr/local/php/etc/php.ini
/usr/local/apache2/bin/apachectl stop
/usr/local/apache2/bin/apachectl start
